<!DOCTYPE html>
<html>
    <head>
        <style>
            #map_canvas {
                width:  750px;
                height: 500px;
            }
        </style>
        <script src='https://maps.googleapis.com/maps/api/js?sensor=false&libraries=visualization'></script>
        <script>
            var map;
            function initialize() {
                var map_canvas = document.getElementById('map_canvas');
                var map_options = {
                    center: new google.maps.LatLng(40.7718667, -73.9737833),
                    zoom: 2,
                    mapTypeId: google.maps.MapTypeId.ROADMAP
                };
                map = new google.maps.Map(map_canvas, map_options);
                var xhr = new XMLHttpRequest();
                xhr.open('GET', 'earthquake.json', true);
                xhr.onload = function() {
                    load_geojson(JSON.parse(this.responseText));
                };
                xhr.send();
            }
            google.maps.event.addDomListener(window, 'load', initialize);
            function load_geojson(results) {
                for (var i = 0; i < results.features.length; i++){
                    var earthquake = results.features[i];
                    var coords = earthquake.geometry.coordinates;
                    var lat_lng = new google.maps.LatLng(coords[1], coords[0]);
                    var marker = new google.maps.Marker({
                        position: lat_lng,
                        map: map,
                        icon: getCircle(earthquake.properties.mag)
                    });
                }
            }
            function getCircle(magnitude){
                var circle = {
                    fillColor: 'red',
                    fillOpacity: .2,
                    path: google.maps.SymbolPath.CIRCLE,
                    scale: Math.pow(2, magnitude)/Math.PI,
                    strokeColor: 'white',
                    strokeWeight: .5
                };
                return circle;
            }
        </script>
    </head>
    <body>
        <div id='map_canvas'></div>
    </body>
</html>

